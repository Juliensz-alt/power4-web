<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Power4 Web - Jeu Puissance 4</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üéØ Power4 Web</h1>
            <p class="subtitle">Jeu Puissance 4 en ligne</p>
        </header>

        <main>
            <!-- √âcran de menu avant le d√©but de la partie -->
            {{if not .Started}}
            <section class="menu-screen">
                <h2>Bienvenue dans Power4</h2>
                <p class="menu-subtitle">Pr√©parez-vous pour une partie de Puissance 4 !</p>

                <form action="/start" method="POST" class="menu-actions">
                    <button type="submit" class="btn btn-play">‚ñ∂ Jouer</button>
                </form>

                <p class="menu-hint">Astuce: Cliquez sur une colonne (1 √† 7) pour d√©poser un jeton.</p>
            </section>
            {{end}}

            <!-- Informations du jeu -->
            <div class="game-info {{if not .Started}}hidden{{end}}">
                <div class="current-player">
                    <span class="label">Joueur actuel :</span>
                    <span class="player-indicator player-{{.CurrentPlayer}}">
                        Joueur {{.CurrentPlayer}}
                    </span>
                </div>
                <div class="game-status">
                    <span class="status-message">{{.Message}}</span>
                </div>
            </div>

            <!-- Plateau de jeu -->
            <div class="game-board {{if not .Started}}hidden{{end}}">
                <table class="board-table">
                    {{range $row := .Board}}
                    <tr>
                        {{range $col := $row}}
                        <td class="cell {{if eq $col 1}}player-1{{else if eq $col 2}}player-2{{end}}">
                            {{if eq $col 1}}
                                <div class="token player-1">‚óè</div>
                            {{else if eq $col 2}}
                                <div class="token player-2">‚óè</div>
                            {{else}}
                                <div class="token empty"></div>
                            {{end}}
                        </td>
                        {{end}}
                    </tr>
                    {{end}}
                </table>
            </div>

            <!-- Contr√¥les de jeu -->
            <div class="game-controls {{if not .Started}}hidden{{end}}">
                <form action="/play" method="POST" class="column-selector">
                    <div class="column-buttons">
                        {{range $i := seq 1 7}}
                        <button type="submit" name="column" value="{{$i}}" class="column-btn">
                            {{$i}}
                        </button>
                        {{end}}
                    </div>
                </form>

                <div class="action-buttons">
                    <a href="/" class="btn btn-secondary">Actualiser</a>
                    <form action="/quit" method="POST" style="display: inline;">
                        <button type="submit" class="btn btn-secondary">Retour au menu</button>
                    </form>
                    <form action="/reset" method="POST" style="display: inline;">
                        <button type="submit" class="btn btn-primary">Nouvelle partie</button>
                    </form>
                </div>
            </div>

            <!-- Informations des joueurs -->
            <div class="players-info {{if not .Started}}hidden{{end}}">
                <div class="player-info player-1">
                    <div class="player-token">‚óè</div>
                    <span>{{.Player1Name}}</span>
                </div>
                <div class="player-info player-2">
                    <div class="player-token">‚óè</div>
                    <span>{{.Player2Name}}</span>
                </div>
            </div>

            <!-- Statut de fin de jeu -->
            {{if and .Started .GameOver}}
            <div class="game-over">
                {{if .Winner}}
                <h2>üéâ F√©licitations !</h2>
                <p>Le <strong>Joueur {{.Winner}}</strong> a gagn√© !</p>
                {{else}}
                <h2>ü§ù Match nul !</h2>
                <p>La grille est pleine, personne n'a gagn√©.</p>
                {{end}}
            </div>
            {{end}}
        </main>

        <footer>
            <p>Power4 Web - D√©velopp√© avec Go et HTML Templates</p>
        </footer>
    </div>

    <script>

        // Animation des boutons de colonne
        document.querySelectorAll('.column-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                this.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    this.style.transform = 'scale(1)';
                }, 150);
            });
        });

        // Mise en √©vidence de la colonne survol√©e
        document.querySelectorAll('.column-btn').forEach(btn => {
            btn.addEventListener('mouseenter', function() {
                const column = parseInt(this.value) - 1;
                const cells = document.querySelectorAll(`.board-table tr td:nth-child(${column + 1})`);
                cells.forEach(cell => {
                    cell.classList.add('highlight');
                });
            });

            btn.addEventListener('mouseleave', function() {
                const column = parseInt(this.value) - 1;
                const cells = document.querySelectorAll(`.board-table tr td:nth-child(${column + 1})`);
                cells.forEach(cell => {
                    cell.classList.remove('highlight');
                });
            });
        });
    </script>
</body>
</html>
